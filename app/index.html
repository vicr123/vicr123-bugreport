<!DOCTYPE >
<html>
    <head>
        <title>vicr123 Bug Reporting</title>
        <link rel="stylesheet" href="/contemporary.css" />
        <link rel="stylesheet" href="/app/app.css" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <meta name="HandheldFriendly" content="true">
        <link rel="shortcut icon" href="/icon.png" />
        <script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
        <script>if (window.module) module = window.module;</script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.7.6/showdown.min.js"></script>
        <script src="/app/xss.js" type="text/javascript"></script>
        <script src="/contemporary.js"></script>
        <script src="/app/app.js"></script>
        <script src="/autosize.min.js"></script>
    </head>
    <body onload="load()">
        <div class="blanker" id="blanker"></div>
        <div class="mainHeader" id="mainHeader">
            <div class="headerProject">
                <img class="smileIcon" src="/images/smile.png">
                <div class="headerTitle">Bug Reporting</div>
                <span class="admin">Administrator</span>
            </div>
            <div id="headerButtons" class="headerButtons">
                <div class="headerItem" onclick="fileBug()">
                    File New Ticket
                </div>
                <div class="headerItem" id="userSettings" onclick="userSettings()">
                    Log In
                </div>
            </div>
        </div>
        
        <div class="landing" id="initialLanding">
            <h1>Bug Reporting</h1>
            <div class="loader"></div>
            <p id="loadingStatus">Loading assets...</p>
        </div>
        <div class="content projects" id="contentContainer">
            <div id="projects" class="list">
                
            </div>
            <div id="bugs" class="list" style="position: relative;">
                <div class="coverLoader" id="coverLoaderBugs">
                    <div class="loader"></div>
                </div>
            </div>
            <div id="bugInfo" class="panel">
                <div class="parentButton" onclick="$('#contentContainer').removeClass('bugInfo');$('#contentContainer').addClass('bugs');">
                    <img src="/images/arrow-left.svg" />Go Back
                </div>
                <div id="bugCover">
                    <h1>Welcome!</h1>
                    <img src="/images/landing.svg" />
                    <p>Browse tickets using the list on the left.</p>
                    <div class="buttonBar">
                        <a href="#" class="button" onclick="fileBug()">File New Ticket</a>
                    </div>
                </div>
                <div id="bugContents">
                    <div class="bugTop" id="bugTop">
                            <h1 id="bugTitle">Ticket Title</h1>
                            <div id="bugMetadata">
                                <table>
                                    <tbody>
                                        <tr>
                                            <th>Importance</th>
                                            <td id="bugImportance"></td>
                                        </tr>
                                        <tr>
                                            <th>Status</th>
                                            <td id="bugOpen"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                    </div>
                    <div class="bugBody" id="bugBodyWrapper">
                        <div id="bugBody" class="bugContents"></div>
                        <div class="bugBodyMetadata">
                            <img id="bugProfilePicture" class="small profile" />
                            <span id="bugReporter"></span> &bullet; 
                            <span id="bugTimestamp"></span>
                        </div>
                    </div>
                    <div id="bugComments">
                    </div>
                    <div style="display: flex; align-items: center; justify-content: center;" id="bugLoader">
                        <div class="loader"></div>
                    </div>
                    <div id="commentsWrapper">
                        <div id="commentsBox">
                            <input type="file" id="commentsFileUploader" multiple style="display: none" onchange="uploadAttachments(this.files)"/>
                            <div class="dropTarget" id="commentsDropTarget">
                                <h1>Drop files</h1>
                                <p>Drop files here to attach them to this comment</p>
                            </div>
                            <textarea class="autogrow" id="commentText" placeholder="Write a comment..."></textarea>
                        </div>
                        <div id="bugActions">
                            <a class="button flat commentButton" onclick="patchCurrentBug({isOpen: false})" id="btnCloseBug"><img src="/images/dialog-ok.svg" />Close</a>
                            <a class="button flat commentButton" onclick="patchCurrentBug({isOpen: true})" id="btnReopenBug"><img src="/images/start-over.svg" />Reopen</a>
                            <span class="spacer"></span>
                                <a href="#" class="flat button" onclick="document.getElementById('commentsFileUploader').click();"><img src="/images/mail-attachment.svg" alt="Attach File"/></a>
                                <a class="button" onclick="sendComment()" /><img src="/images/mail-send.svg" />Send</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="newBug" id="newBug">
            <div class="dropTarget" id="newBugDropTarget">
                <h1>Drop files</h1>
                <p>Drop files here to attach them to this ticket</p>
            </div>
            <h1>File a new ticket in <span id="newBugProjectName"></span></h1>
            <input type="text" id="newBugTitle" placeholder="Ticket Title"/>
            <textarea id="newBugContent" placeholder="Describe what you think needs to be changed"></textarea>
            <a class="button list flat" id="bugSettingsButton" onclick="$('#newBugSettings').addClass('show');">
                <div>
                    <h3>More Settings</h3>
                    <p>Importance, Visibility...</p>
                </div>
            </a>
            <input type="file" id="newBugFileUploader" multiple style="display: none" onchange="uploadNewBugAttachment(this.files)"/>
            <div class="uploads" id="newBugFileUploads">
            </div>
            <div class="buttonBar">
                <a href="#" class="button" onclick="cancelFileBug()">Cancel</a>
                <span class="spacer"></span>
                <a href="#" class="flat button" onclick="document.getElementById('newBugFileUploader').click();"><img src="/images/mail-attachment.svg" alt="Attach File"/></a>
                <a href="#" class="button" onclick="doFileBug()">File Ticket</a>
            </div>
        </div>
        <div class="newBug" id="newBugSettings">
            <h1>Extra Settings</h1>
            <p>Set extra properties of this ticket</p>
            <div class="newBugSetting">
                <h3>Importance</h3>
                <p>How important is this ticket? Is it a feature request, or is it a grave security issue?</p>
                <select id="newBugImportance">
                    <option value="0">Fatal</option>
                    <option value="1">Critical</option>
                    <option value="2">High</option>
                    <option value="3" selected>Normal</option>
                    <option value="4">Low</option>
                    <option value="5">Trivial</option>
                    <option value="6">Feature Request</option>
                </select>
            </div>
            <div class="newBugSetting">
                <h3>Privacy</h3>
                <p>Does this ticket contain a security issue?</p>
                <input type="radio" id="publicBug" name="newBugSecurity" checked/><label for="publicBug">Make Public</label>
                <input type="radio" id="privateBug" name="newBugSecurity"/><label for="privateBug">Keep Private</label>
                <p class="error">Only set this to "Keep Private" if you are reporting a security issue.</p>
            </div>
            <div class="buttonBar">
                <span class="spacer"></span>
                <a href="#" class="button" onclick="$('#newBugSettings').removeClass('show');">Done</a>
            </div>
        </div>

        <div class="toast" id="toast">
            <span id="toast-header">Toast Header</span>
            <span id="toast-contents">Toast Contents</span>
            <span id="toast-buttons">
                
            </span>
        </div>
        <div class="cxMenu" id="cxMenu">
            <div class="menuHeader">Menu Header</div>
            <div class="menuItem">Menu Item 1</div>
            <div class="menuItem">Menu Item 2</div>
            <div class="menuSeperator"></div>
            <div class="menuItem">Menu Item 3</div>
            <div class="menuItem">Menu Item 4</div>
            <div class="menuItem">Menu Item 5</div>
        </div>

        <div class="dialog" id="dlgLoadFail">
            <img src="/images/dialog-warning.svg" class="icon" />
            <h1>Load Error</h1>
            <p>Loading the Bug Reporting tool failed. This might be because of a server error, or it may be because of an unstable internet connection.</p>
            <div class="buttonBar">
                <a href="#" class="button" onclick="location.reload();">Reload</a>
            </div>
        </div>
        <div class="dialog" id="dlgConnectFail">
            <img src="/images/dialog-warning.svg" class="icon" />
            <h1>Connection Error</h1>
            <p>Couldn't connect to the server.</p>
            <div class="buttonBar">
                <a href="#" class="button" onclick="location.reload();">Reload</a>
            </div>
        </div>
        <div class="dialog" id="dlgOffline">
            <img src="/images/dialog-warning.svg" class="icon" />
            <h1>Offline</h1>
            <p>You are offline. To continue using the bugtracker, connect to the internet.</p>
            <div class="buttonBar">
                <a href="#" class="button" onclick="location.reload();">Reload</a>
            </div>
        </div>
        <div class="dialog" id="dlgDisconnected">
            <img src="/images/dialog-warning.svg" class="icon" />
            <h1>Disconnected</h1>
            <p>You have been disconnected from the server.</p>
            <div class="buttonBar">
                <a href="#" class="button" onclick="location.reload();">Reload</a>
            </div>
        </div>
        <div class="dialog" id="dlgLoginRequired">
            <img src="/images/dialog-warning.svg" class="icon" />
            <h1>Log In</h1>
            <p>You'll need to log in to perform this action.</p>
            <div class="buttonBar">
                <a href="#" class="button" onclick="login();">Log In</a>
                <a href="#" class="button" onclick="dismissDialog('dlgLoginRequired');">Cancel</a>
            </div>
        </div>
        <div class="dialog" id="dlgGenericOkWarning">
            <img src="/images/dialog-warning.svg" class="icon" />
            <h1 id="genericOkWarningTitle">Title</h1>
            <p id="genericOkWarningText">Text</p>
            <div class="buttonBar">
                <a href="#" class="button" onclick="dismissDialog('dlgGenericOkWarning');">OK</a>
            </div>
        </div>
        <div class="dialog" id="dlgLogin">
            <iframe src="/app/login.html" id="loginiFrame"></iframe>
        </div>
        <div class="dialog noicon" id="dlgEdit">
            <div id="dlgEditWrapper">
                <h1>Edit Comment</h1>
                <p>How would you like to amend your comment?</p>
                <textarea id="editCommentText" placeholder="Write a comment..." style="width: 100%;"></textarea>
                <div class="buttonBar" style="margin-top: 6px;">
                    <a href="#" class="button" onclick="editCommentCommit()">Edit</a>
                    <span class="spacer"></span>
                    <a href="#" class="button" onclick="dismissDialog('dlgEdit');">Cancel</a>
                </div>
            </div>
        </div>
        <div class="dialog noicon" id="dlgUserManagement">
            <h1>User Management</h1>
            <p>Hello <span id="userManagementUsername"></span>! What would you like to do today?</p>
            <span class="spacer"></span>
            <a href="#" class="button" onclick="dismissDialog('dlgUserManagement'); showDialog('dlgProfileSettings')">Profile and Account</a>
            <a href="#" class="button" onclick="dismissDialog('dlgUserManagement'); showDialog('dlg2fa')">Two Factor Authentication</a>
            <a href="#" class="button destructive" onclick="dismissDialog('dlgUserManagement'); $('#deleteAccountError').removeClass('show'); showDialog('dlgDeleteAccount')">Delete my Account</a>
            <div class="buttonBar" style="margin-top: 6px;">
                <a href="#" class="button" onclick="dismissDialog('dlgUserManagement');">Done</a>
                <span class="spacer"></span>
                <a href="#" class="button" onclick="dismissDialog('dlgUserManagement'); showDialog('dlgLogout')">Log Out</a>
            </div>
        </div>
        <div class="dialog" id="dlgProfileSettings">
            <iframe src="/app/usersettings.html" id="usersettingsiframe"></iframe>
        </div>
        <div class="dialog" id="dlgLogout">
            <img src="/images/dialog-warning.svg" class="icon" />
            <h1>Log Out</h1>
            <p>Do you want to log out of your account?</p>
            <div class="buttonBar">
                <a href="#" class="button" onclick="logout();">Log Out</a>
                <a href="#" class="button" onclick="dismissDialog('dlgLogout');showDialog('dlgUserManagement');">Cancel</a>
            </div>
        </div>
        <div class="dialog noicon" id="dlgDeleteAccount">
            <h1>Delete Account</h1>
            <p>Here's what's going to happen</p>
            <ul>
                <li>You will no longer be able to log in</li>
                <li>You will no longer be able to file new tickets</li>
                <li>You will no longer be able to participate in comments</li>
                <li>Your current username and email address will be available for use by new accounts</li>
                <li>Your comments and existing tickets will not be deleted</li>
            </ul>
            <p>If you're sure you want to delete your account, enter your password below to confirm that it's you.</p>
            <input type="password" id="deleteAccountPassword" style="width: 100%;"/>
            <span class="error" id="deleteAccountError">That didn't work. Try entering your password again.</span>
            <p style="font-weight: bold;">WARNING: This is the final step. Your account will be deleted after you click "Delete my account."</p>
            <div class="buttonBar">
                <a href="#" class="button destructive" onclick="deleteAccount();">Delete my account</a>
                <a href="#" class="button" onclick="dismissDialog('dlgDeleteAccount');showDialog('dlgUserManagement');">Cancel</a>
            </div>
        </div>
        <div class="dialog" id="dlg2fa">
            <iframe src="/app/2fa.html" id="2faiFrame"></iframe>
        </div>
        <div class="dialog" id="dlgLink">
            <img src="/images/dialog-warning.svg" class="icon" />
            <h1>Obfuscated Link</h1>
            <p>Links from other people can be dangerous. The link you clicked on will go to the following address:</p>
            <pre id="linkDialogLink"></pre>
            <p>Do you want to visit this site?</p>
            <div class="buttonBar">
                <a href="#" class="button" onclick="visitObfuscatedLink()">Visit</a>
                <a href="#" class="button" onclick="dismissDialog('dlgLink');">Cancel</a>
            </div>
        </div>
        <div class="dialog" id="dlgRatelimit">
            <img src="/images/dialog-warning.svg" class="icon" />
            <h1>You are being rate limited</h1>
            <p>Your rate limit resets on <span id="ratelimitReset"></span>.</p>
            <p>Reload the page after that time to continue using the bugtracker.</p>
        </div>
        
        <script>
            //Check for compatibility
            if (typeof(Storage) === "undefined") {
                window.location = "/";
            }
        </script>
    </body>
</html>
